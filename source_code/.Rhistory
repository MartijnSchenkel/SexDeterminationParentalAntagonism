library(tidyverse)
library(viridis)
Hvar <- seq(0, 0.95, 0.01)
Svar <- seq(-0.95, 0, 0.01)
d <- tibble(s = numeric(),
h = numeric(),
Kcrit = numeric())
for(s in Svar) for(h in Hvar)
{
Kcrit <- -(2*h*s) / (1 + h*s)
dt <- tibble(s, h, Kcrit)
d <- d %>% full_join(dt, by = names(dt))
}
d2 <- d %>% filter(h < 0.95, s > -0.95, Kcrit <= 1)
d2 %>% ggplot(aes(s, h, fill = Kcrit)) + geom_tile() + scale_fill_viridis()
